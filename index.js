// Generated by CoffeeScript 1.6.2
var async, jelly, jy, path;

jy = require('jellyjs');

async = require('async');

path = require('path');

jelly = new jy.Jelly();

jelly.setRootDirectory(__dirname);

async.series([
  function(cb) {
    return jelly.readJellyConfigurationFile(function(err) {
      return cb(err, null);
    });
  }, function(cb) {
    return jelly.readAllGeneralConfigurationFiles(function(err) {
      return cb(err, null);
    });
  }, function(cb) {
    return jelly.getPluginDirectoryList().readAllPlugins(function(err) {
      return cb(err, null);
    });
  }, function(cb) {
    var httpServerPlugin;

    httpServerPlugin = path.dirname(require.resolve('jellyjs-plugin-httpserver'));
    return jelly.getPluginDirectoryList().readPluginFromPath(httpServerPlugin, 'httpserver', cb);
  }, function(cb) {
    return jelly.applyPluginsSpecified(true, function(err) {
      return cb(err);
    });
  }
], function(err, res) {
  if (err != null) {
    console.error("ERROR:", err);
    return process.exit(1);
  }
});
